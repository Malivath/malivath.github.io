<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Matthew Fuller's Portfolio | Digital Universe</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Orbitron:wght@400;700;900&family=Roboto:wght@300;400;700&display=swap" rel="stylesheet">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      overflow: hidden;
      background: #000010;
      font-family: 'Montserrat', sans-serif;
      color: white;
    }

    #canvas-container {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: 1;
    }

    /* Loading Screen */
    #loading-screen {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: radial-gradient(ellipse at center, #0a0a2e 0%, #000010 100%);
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      z-index: 1000;
      transition: opacity 1s ease-out;
    }

    #loading-screen.fade-out {
      opacity: 0;
      pointer-events: none;
    }

    .loading-title {
      font-family: 'Orbitron', sans-serif;
      font-size: 2.5rem;
      color: #64b5f6;
      margin-bottom: 30px;
      text-shadow: 0 0 30px #1976d2;
      animation: pulse 2s ease-in-out infinite;
    }

    .loading-bar-container {
      width: 300px;
      height: 4px;
      background: rgba(255, 255, 255, 0.1);
      border-radius: 2px;
      overflow: hidden;
    }

    .loading-bar {
      height: 100%;
      width: 0%;
      background: linear-gradient(90deg, #1976d2, #64b5f6, #1976d2);
      background-size: 200% 100%;
      animation: shimmer 1.5s infinite;
      transition: width 0.3s;
    }

    .loading-text {
      margin-top: 20px;
      font-size: 0.9rem;
      color: rgba(255, 255, 255, 0.5);
    }

    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.7; }
    }

    @keyframes shimmer {
      0% { background-position: -200% 0; }
      100% { background-position: 200% 0; }
    }

    /* UI Overlay */
    #ui-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: 10;
    }

    /* Header */
    #header {
      position: absolute;
      top: 20px;
      left: 50%;
      transform: translateX(-50%);
      text-align: center;
      pointer-events: auto;
      opacity: 0;
      animation: fadeInDown 1s ease-out 1.5s forwards;
    }

    #header h1 {
      font-family: 'Orbitron', sans-serif;
      font-size: 1.8rem;
      font-weight: 700;
      color: #fff;
      text-shadow: 0 0 20px rgba(25, 118, 210, 0.8);
      letter-spacing: 3px;
    }

    #header p {
      font-size: 0.9rem;
      color: rgba(255, 255, 255, 0.6);
      margin-top: 5px;
    }

    @keyframes fadeInDown {
      from {
        opacity: 0;
        transform: translateX(-50%) translateY(-20px);
      }
      to {
        opacity: 1;
        transform: translateX(-50%) translateY(0);
      }
    }

    /* Navigation hint */
    #nav-hint {
      position: absolute;
      bottom: 30px;
      left: 50%;
      transform: translateX(-50%);
      text-align: center;
      opacity: 0;
      animation: fadeIn 1s ease-out 2s forwards;
    }

    #nav-hint p {
      font-size: 0.85rem;
      color: rgba(255, 255, 255, 0.5);
    }

    #nav-hint .mobile-hint {
      display: none;
    }

    #nav-hint .scroll-icon {
      width: 24px;
      height: 40px;
      border: 2px solid rgba(255, 255, 255, 0.3);
      border-radius: 12px;
      margin: 10px auto;
      position: relative;
    }

    #nav-hint .scroll-icon::before {
      content: '';
      position: absolute;
      top: 8px;
      left: 50%;
      transform: translateX(-50%);
      width: 4px;
      height: 8px;
      background: #64b5f6;
      border-radius: 2px;
      animation: scrollBounce 2s ease-in-out infinite;
    }

    @keyframes scrollBounce {
      0%, 100% { top: 8px; opacity: 1; }
      50% { top: 20px; opacity: 0.3; }
    }

    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }

    /* Info Panel */
    #info-panel {
      position: absolute;
      right: -450px;
      top: 50%;
      transform: translateY(-50%);
      width: 400px;
      max-height: 80vh;
      background: rgba(10, 20, 40, 0.85);
      backdrop-filter: blur(20px);
      border: 1px solid rgba(100, 181, 246, 0.3);
      border-radius: 20px;
      padding: 30px;
      pointer-events: auto;
      transition: right 0.5s cubic-bezier(0.4, 0, 0.2, 1);
      box-shadow: 0 0 60px rgba(25, 118, 210, 0.3),
                  inset 0 0 60px rgba(25, 118, 210, 0.05);
      overflow-y: auto;
    }

    #info-panel.active {
      right: 30px;
    }

    #info-panel h2 {
      font-family: 'Orbitron', sans-serif;
      font-size: 1.5rem;
      color: #64b5f6;
      margin-bottom: 15px;
      text-shadow: 0 0 20px rgba(100, 181, 246, 0.5);
    }

    #info-panel p {
      font-size: 0.95rem;
      line-height: 1.7;
      color: rgba(255, 255, 255, 0.8);
      margin-bottom: 15px;
    }

    #info-panel .btn {
      display: inline-block;
      padding: 12px 24px;
      margin: 8px 8px 8px 0;
      background: linear-gradient(135deg, #1976d2 0%, #0d47a1 100%);
      color: white;
      text-decoration: none;
      border-radius: 8px;
      font-weight: 600;
      font-size: 0.9rem;
      transition: all 0.3s;
      border: 1px solid rgba(100, 181, 246, 0.3);
    }

    #info-panel .btn:hover {
      background: linear-gradient(135deg, #1e88e5 0%, #1565c0 100%);
      transform: translateY(-2px);
      box-shadow: 0 5px 20px rgba(25, 118, 210, 0.4);
    }

    #close-panel {
      position: absolute;
      top: 15px;
      right: 15px;
      width: 36px;
      height: 36px;
      background: rgba(255, 255, 255, 0.1);
      border: none;
      border-radius: 50%;
      color: white;
      font-size: 1.2rem;
      cursor: pointer;
      transition: all 0.3s;
    }

    #close-panel:hover {
      background: rgba(255, 100, 100, 0.3);
      transform: rotate(90deg);
    }

    /* Social Links */
    #social-links {
      position: absolute;
      bottom: 30px;
      right: 30px;
      display: flex;
      gap: 15px;
      pointer-events: auto;
      opacity: 0;
      animation: fadeIn 1s ease-out 2.5s forwards;
    }

    .social-btn {
      width: 50px;
      height: 50px;
      background: rgba(25, 118, 210, 0.2);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(100, 181, 246, 0.3);
      border-radius: 50%;
      display: flex;
      justify-content: center;
      align-items: center;
      transition: all 0.3s;
      text-decoration: none;
    }

    .social-btn:hover {
      background: rgba(25, 118, 210, 0.5);
      transform: translateY(-3px);
      box-shadow: 0 5px 20px rgba(25, 118, 210, 0.4);
    }

    .social-btn svg {
      width: 24px;
      height: 24px;
      fill: white;
    }

    /* Back button */
    #back-btn {
      position: absolute;
      top: 20px;
      left: 20px;
      padding: 10px 20px;
      background: rgba(25, 118, 210, 0.2);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(100, 181, 246, 0.3);
      border-radius: 25px;
      color: white;
      font-size: 0.9rem;
      cursor: pointer;
      pointer-events: auto;
      opacity: 0;
      visibility: hidden;
      transition: all 0.3s;
    }

    #back-btn.visible {
      opacity: 1;
      visibility: visible;
    }

    #back-btn:hover {
      background: rgba(25, 118, 210, 0.4);
    }

    /* Planet Labels */
    .planet-label {
      position: absolute;
      font-family: 'Orbitron', sans-serif;
      font-size: 0.75rem;
      color: rgba(255, 255, 255, 0.9);
      text-shadow: 0 0 10px rgba(100, 181, 246, 0.8), 0 0 20px rgba(100, 181, 246, 0.5);
      pointer-events: none;
      white-space: nowrap;
      transform: translate(-50%, -50%);
      transition: opacity 0.3s;
      background: rgba(0, 10, 30, 0.6);
      padding: 6px 12px;
      border-radius: 15px;
      border: 1px solid rgba(100, 181, 246, 0.3);
      backdrop-filter: blur(5px);
    }

    .planet-label::before {
      content: '';
      position: absolute;
      bottom: -8px;
      left: 50%;
      transform: translateX(-50%);
      width: 2px;
      height: 8px;
      background: linear-gradient(to bottom, rgba(100, 181, 246, 0.5), transparent);
    }

    /* Cursor */
    body {
      cursor: default;
    }

    .clickable {
      cursor: pointer;
    }

    /* Mobile responsive */
    @media (max-width: 768px) {
      /* Header adjustments */
      #header {
        top: 15px;
        width: 90%;
        padding: 0 10px;
      }

      #header h1 {
        font-size: 1.1rem;
        letter-spacing: 2px;
      }

      #header p {
        font-size: 0.75rem;
        margin-top: 3px;
      }

      /* Back button - larger touch target */
      #back-btn {
        top: 15px;
        left: 15px;
        padding: 12px 18px;
        font-size: 0.85rem;
        min-width: 44px;
        min-height: 44px;
      }

      /* Info panel - slide up from bottom */
      #info-panel {
        width: 100%;
        right: 0;
        left: 0;
        top: auto;
        bottom: -100%;
        transform: none;
        max-height: 70vh;
        border-radius: 20px 20px 0 0;
        padding: 25px 20px;
        padding-bottom: 30px;
      }

      #info-panel.active {
        right: 0;
        left: 0;
        bottom: 0;
      }

      #info-panel h2 {
        font-size: 1.25rem;
        margin-bottom: 12px;
        padding-right: 30px;
      }

      #info-panel p {
        font-size: 0.9rem;
        line-height: 1.6;
        margin-bottom: 12px;
      }

      #info-panel .btn {
        display: block;
        width: 100%;
        text-align: center;
        padding: 14px 20px;
        margin: 10px 0;
        font-size: 0.95rem;
      }

      #close-panel {
        width: 44px;
        height: 44px;
        top: 12px;
        right: 12px;
        font-size: 1.4rem;
      }

      /* Social links - move to top right to avoid conflicts */
      #social-links {
        top: 15px;
        bottom: auto;
        right: 15px;
        gap: 10px;
      }

      .social-btn {
        width: 44px;
        height: 44px;
      }

      .social-btn svg {
        width: 20px;
        height: 20px;
      }

      /* Navigation hint - mobile-friendly text */
      #nav-hint {
        bottom: 20px;
        width: 90%;
        left: 50%;
      }

      #nav-hint p {
        font-size: 0.75rem;
        line-height: 1.4;
      }

      #nav-hint .desktop-hint {
        display: none;
      }

      #nav-hint .mobile-hint {
        display: block;
      }

      #nav-hint .scroll-icon {
        display: none;
      }

      /* Planet labels - smaller and more readable */
      .planet-label {
        font-size: 0.65rem;
        padding: 5px 10px;
        border-radius: 12px;
      }

      .planet-label::before {
        height: 6px;
        bottom: -6px;
      }
    }

    /* Extra small devices */
    @media (max-width: 380px) {
      #header h1 {
        font-size: 0.95rem;
        letter-spacing: 1px;
      }

      #header p {
        font-size: 0.7rem;
      }

      #info-panel {
        max-height: 75vh;
        padding: 20px 15px;
      }

      #info-panel h2 {
        font-size: 1.1rem;
      }

      #info-panel p {
        font-size: 0.85rem;
      }

      .social-btn {
        width: 40px;
        height: 40px;
      }

      #back-btn {
        padding: 10px 14px;
        font-size: 0.8rem;
      }
    }

    /* Landscape mode on mobile */
    @media (max-height: 500px) and (orientation: landscape) {
      #header {
        display: none;
      }

      #info-panel {
        max-height: 85vh;
        width: 50%;
        right: -60%;
        left: auto;
        top: 50%;
        bottom: auto;
        transform: translateY(-50%);
        border-radius: 20px;
      }

      #info-panel.active {
        right: 10px;
        left: auto;
        bottom: auto;
      }

      #nav-hint {
        bottom: 10px;
      }

      #social-links {
        top: auto;
        bottom: 10px;
        right: 10px;
      }
    }
  </style>
</head>
<body>
  <!-- Loading Screen -->
  <div id="loading-screen">
    <h1 class="loading-title">INITIALIZING UNIVERSE</h1>
    <div class="loading-bar-container">
      <div class="loading-bar" id="loading-bar"></div>
    </div>
    <p class="loading-text">Generating stars...</p>
  </div>

  <!-- 3D Canvas -->
  <div id="canvas-container"></div>

  <!-- UI Overlay -->
  <div id="ui-overlay">
    <div id="header">
      <h1>MATTHEW FULLER</h1>
      <p>Web Developer & Innovator</p>
    </div>

    <button id="back-btn">← Return to Universe</button>

    <div id="info-panel">
      <button id="close-panel">×</button>
      <h2 id="panel-title">Title</h2>
      <div id="panel-content"></div>
    </div>

    <div id="nav-hint">
      <p class="desktop-hint">Scroll to zoom • Click planets to explore • Drag to orbit</p>
      <p class="mobile-hint">Tap planets to explore • Pinch to zoom • Swipe to orbit</p>
      <div class="scroll-icon"></div>
    </div>

    <div id="social-links">
      <a href="https://www.linkedin.com/in/matthew-f-a73190244" target="_blank" class="social-btn" title="LinkedIn">
        <svg viewBox="0 0 24 24">
          <path d="M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"/>
        </svg>
      </a>
      <a href="https://github.com/malivath" target="_blank" class="social-btn" title="GitHub">
        <svg viewBox="0 0 24 24">
          <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/>
        </svg>
      </a>
    </div>

    <!-- Planet Labels -->
    <div id="planet-labels"></div>
  </div>

  <!-- Three.js -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
  <script src="https://unpkg.com/three@0.128.0/examples/js/controls/OrbitControls.js"></script>
  
  <script>
    // ===========================================
    // DIGITAL UNIVERSE - Matthew Fuller Portfolio
    // ===========================================

    // Portfolio Data
    const portfolioData = {
      about: {
        title: "About Me",
        content: `
          <p>Greetings! I am Matt, a Full Stack Developer specializing in modern JAMstack architecture.</p>
          <p>My primary tech stack includes React, Vite, and PostgreSQL - tools that enable me to build fast, scalable, and maintainable web applications. I'm passionate about leveraging these technologies to create seamless user experiences from front to back.</p>
          <p>What drives me in web development is the opportunity to combine my problem-solving abilities with technical expertise. I thrive on understanding client challenges and architecting solutions that not only meet their needs but exceed their expectations.</p>
          <p>Whether it's optimizing performance, designing intuitive interfaces, or building robust backend systems, I approach each project with enthusiasm and a commitment to delivering exceptional results.</p>
        `,
        color: 0x4fc3f7,
        links: []
      },
      certifications: {
        title: "Certifications",
        content: `
          <p>A collection of professional certifications and certificates earned through dedicated learning and skill development.</p>
          <p>Including the Google IT Support Professional Certificate and various other achievements in web development and technology.</p>
        `,
        color: 0xffd54f,
        links: [
          { text: "View Certifications", url: "../certificates/certs.html" }
        ]
      },
      coursera: {
        title: "Coursera Portfolio",
        content: `
          <p>A dedicated portfolio showcasing projects and learning outcomes from Coursera courses and specializations.</p>
          <p>This collection demonstrates practical applications of skills learned through structured online education.</p>
        `,
        color: 0x81c784,
        links: [
          { text: "View Portfolio", url: "../CorseraPortfolio/index.html" }
        ]
      },
      lakesarea: {
        title: "Lakes Area Undercoating",
        content: `
          <p>A professional business website developed for Lakes Area Undercoating - a real-world client project demonstrating full-stack web development capabilities.</p>
          <p>Features responsive design, modern UI/UX principles, and optimized performance.</p>
        `,
        color: 0xff8a65,
        links: [
          { text: "Visit Website", url: "https://lakesareaundercoating.com/" }
        ]
      },
      lovedictionary: {
        title: "Love Dictionary",
        content: `
          <p>An interactive web application that explores the language of love through creative definitions and expressions.</p>
          <p>Built with modern web technologies and featuring an engaging user experience.</p>
        `,
        color: 0xf48fb1,
        links: [
          { text: "Visit Website", url: "https://lovedictionary.net/" },
          { text: "View Documentation", url: "#", onclick: "openDocumentation()" }
        ]
      },
      moonleaf: {
        title: "Moonleaf Tokers",
        content: `
          <p>A creative web project showcasing unique design elements and interactive features.</p>
          <p>Demonstrates proficiency in modern frontend development and creative problem-solving.</p>
        `,
        color: 0xce93d8,
        links: [
          { text: "Visit Website", url: "https://moonleaftokers.com/" }
        ]
      }
    };

    // Scene Setup
    let scene, camera, renderer, controls;
    let planets = [];
    let planetLabels = [];
    let moons = [];
    let starField, nebulaClouds = [];
    let raycaster, mouse;
    let currentFocus = null;
    let currentHover = null;
    let isAnimating = false;
    let clock;
    
    // Camera positions
    const defaultCameraPos = { x: 0, y: 5, z: 25 };
    const focusDistance = 8;

    // Initialize
    function init() {
      clock = new THREE.Clock();
      
      // Scene
      scene = new THREE.Scene();
      scene.fog = new THREE.FogExp2(0x000020, 0.015);

      // Camera
      camera = new THREE.PerspectiveCamera(60, window.innerWidth / window.innerHeight, 0.1, 1000);
      camera.position.set(defaultCameraPos.x, defaultCameraPos.y, defaultCameraPos.z);

      // Renderer
      renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
      renderer.setSize(window.innerWidth, window.innerHeight);
      renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
      renderer.toneMapping = THREE.ACESFilmicToneMapping;
      renderer.toneMappingExposure = 1.2;
      document.getElementById('canvas-container').appendChild(renderer.domElement);

      // Controls
      controls = new THREE.OrbitControls(camera, renderer.domElement);
      controls.enableDamping = true;
      controls.dampingFactor = 0.05;
      controls.maxDistance = 50;
      controls.minDistance = 10;
      controls.enablePan = false;
      controls.autoRotate = true;
      controls.autoRotateSpeed = 0.3;

      // Raycaster for clicking
      raycaster = new THREE.Raycaster();
      mouse = new THREE.Vector2();

      // Create scene elements
      createStarField();
      createNebula();
      createCentralSun();
      createPlanets();
      createPlanetLabels();
      createAmbientParticles();
      addLights();

      // Event listeners
      window.addEventListener('resize', onWindowResize);
      renderer.domElement.addEventListener('click', onMouseClick);
      renderer.domElement.addEventListener('mousemove', onMouseMove);
      
      // Touch event listeners for mobile support
      renderer.domElement.addEventListener('touchstart', onTouchStart, { passive: false });
      renderer.domElement.addEventListener('touchend', onTouchEnd, { passive: false });
      document.getElementById('close-panel').addEventListener('click', () => {
        closePanel();
        returnToOverview();
      });
      document.getElementById('back-btn').addEventListener('click', returnToOverview);

      // Start animation
      animate();
      
      // Hide loading screen
      setTimeout(() => {
        document.getElementById('loading-screen').classList.add('fade-out');
      }, 2000);
    }

    // Create starfield background
    function createStarField() {
      const starsGeometry = new THREE.BufferGeometry();
      const starCount = 15000;
      const positions = new Float32Array(starCount * 3);
      const colors = new Float32Array(starCount * 3);
      const sizes = new Float32Array(starCount);

      for (let i = 0; i < starCount; i++) {
        const i3 = i * 3;
        const radius = 100 + Math.random() * 400;
        const theta = Math.random() * Math.PI * 2;
        const phi = Math.acos(2 * Math.random() - 1);

        positions[i3] = radius * Math.sin(phi) * Math.cos(theta);
        positions[i3 + 1] = radius * Math.sin(phi) * Math.sin(theta);
        positions[i3 + 2] = radius * Math.cos(phi);

        // Star colors (white to blue)
        const colorChoice = Math.random();
        if (colorChoice > 0.9) {
          colors[i3] = 0.6; colors[i3 + 1] = 0.8; colors[i3 + 2] = 1.0; // Blue
        } else if (colorChoice > 0.8) {
          colors[i3] = 1.0; colors[i3 + 1] = 0.9; colors[i3 + 2] = 0.7; // Yellow
        } else {
          colors[i3] = 1.0; colors[i3 + 1] = 1.0; colors[i3 + 2] = 1.0; // White
        }

        sizes[i] = Math.random() * 2 + 0.5;
      }

      starsGeometry.setAttribute('position', new THREE.BufferAttribute(positions, 3));
      starsGeometry.setAttribute('color', new THREE.BufferAttribute(colors, 3));
      starsGeometry.setAttribute('size', new THREE.BufferAttribute(sizes, 1));

      const starsMaterial = new THREE.PointsMaterial({
        size: 0.5,
        vertexColors: true,
        transparent: true,
        opacity: 0.8,
        sizeAttenuation: true
      });

      starField = new THREE.Points(starsGeometry, starsMaterial);
      scene.add(starField);
    }

    // Create nebula clouds
    function createNebula() {
      const nebulaColors = [0x1976d2, 0x7b1fa2, 0x0097a7, 0x303f9f];
      
      for (let i = 0; i < 8; i++) {
        const geometry = new THREE.SphereGeometry(20 + Math.random() * 30, 32, 32);
        const material = new THREE.MeshBasicMaterial({
          color: nebulaColors[Math.floor(Math.random() * nebulaColors.length)],
          transparent: true,
          opacity: 0.03,
          side: THREE.BackSide
        });
        
        const nebula = new THREE.Mesh(geometry, material);
        nebula.position.set(
          (Math.random() - 0.5) * 100,
          (Math.random() - 0.5) * 60,
          (Math.random() - 0.5) * 100 - 50
        );
        nebula.scale.set(
          1 + Math.random(),
          0.5 + Math.random() * 0.5,
          1 + Math.random()
        );
        
        nebulaClouds.push(nebula);
        scene.add(nebula);
      }
    }

    // Create central sun (profile)
    function createCentralSun() {
      // Core sun
      const sunGeometry = new THREE.SphereGeometry(1.8, 64, 64);
      
      // Create sun texture
      const sunCanvas = document.createElement('canvas');
      sunCanvas.width = 512;
      sunCanvas.height = 512;
      const ctx = sunCanvas.getContext('2d');
      
      // Radial gradient for sun surface
      const gradient = ctx.createRadialGradient(256, 256, 0, 256, 256, 256);
      gradient.addColorStop(0, '#ffffff');
      gradient.addColorStop(0.3, '#ffeb3b');
      gradient.addColorStop(0.6, '#ff9800');
      gradient.addColorStop(1, '#ff6f00');
      ctx.fillStyle = gradient;
      ctx.fillRect(0, 0, 512, 512);
      
      // Add solar surface detail
      for (let i = 0; i < 2000; i++) {
        const x = Math.random() * 512;
        const y = Math.random() * 512;
        const size = Math.random() * 2;
        const alpha = Math.random() * 0.4;
        ctx.fillStyle = `rgba(255, 150, 0, ${alpha})`;
        ctx.fillRect(x, y, size, size);
      }
      
      const sunTexture = new THREE.CanvasTexture(sunCanvas);
      
      const sunMaterial = new THREE.MeshBasicMaterial({
        map: sunTexture,
        color: 0xffdd44
      });
      const sun = new THREE.Mesh(sunGeometry, sunMaterial);
      sun.userData.isSun = true;
      scene.add(sun);

      // Inner glow layers
      for (let i = 0; i < 3; i++) {
        const glowGeometry = new THREE.SphereGeometry(2 + i * 0.3, 32, 32);
        const glowMaterial = new THREE.MeshBasicMaterial({
          color: i === 0 ? 0xffeb3b : 0xff9800,
          transparent: true,
          opacity: 0.15 - i * 0.03,
          side: THREE.BackSide
        });
        const glow = new THREE.Mesh(glowGeometry, glowMaterial);
        glow.userData.isSunGlow = true;
        glow.userData.glowIndex = i;
        scene.add(glow);
      }

      // Outer corona
      const coronaGeometry = new THREE.SphereGeometry(3.5, 32, 32);
      const coronaMaterial = new THREE.MeshBasicMaterial({
        color: 0xffa726,
        transparent: true,
        opacity: 0.08,
        side: THREE.BackSide
      });
      const corona = new THREE.Mesh(coronaGeometry, coronaMaterial);
      scene.add(corona);

      // Light rays (more sun-like)
      const rayCount = 16;
      for (let i = 0; i < rayCount; i++) {
        const rayGeometry = new THREE.PlaneGeometry(0.15, 10);
        const rayMaterial = new THREE.MeshBasicMaterial({
          color: 0xffeb3b,
          transparent: true,
          opacity: 0.2,
          side: THREE.DoubleSide
        });
        const ray = new THREE.Mesh(rayGeometry, rayMaterial);
        ray.rotation.z = (i / rayCount) * Math.PI * 2;
        ray.userData.isSunRay = true;
        ray.userData.rayIndex = i;
        scene.add(ray);
      }
      
      // Solar flares (animated particles around sun)
      const flareCount = 20;
      const flareGeometry = new THREE.BufferGeometry();
      const flarePositions = new Float32Array(flareCount * 3);
      
      for (let i = 0; i < flareCount; i++) {
        const angle = (i / flareCount) * Math.PI * 2;
        const radius = 2.2;
        flarePositions[i * 3] = Math.cos(angle) * radius;
        flarePositions[i * 3 + 1] = (Math.random() - 0.5) * 0.5;
        flarePositions[i * 3 + 2] = Math.sin(angle) * radius;
      }
      
      flareGeometry.setAttribute('position', new THREE.BufferAttribute(flarePositions, 3));
      
      const flareMaterial = new THREE.PointsMaterial({
        color: 0xffeb3b,
        size: 0.3,
        transparent: true,
        opacity: 0.8,
        blending: THREE.AdditiveBlending
      });
      
      const flares = new THREE.Points(flareGeometry, flareMaterial);
      flares.userData.isSunFlares = true;
      scene.add(flares);
    }

    // Create orbiting planets
    function createPlanets() {
      const planetConfigs = [
        { key: 'about', radius: 8, speed: 0.3, size: 1.2, yOffset: 0 },
        { key: 'certifications', radius: 11, speed: -0.25, size: 1.0, yOffset: 2 },
        { key: 'coursera', radius: 14, speed: 0.2, size: 1.1, yOffset: -1.5 },
        { key: 'lakesarea', radius: 17, speed: -0.18, size: 1.3, yOffset: 1 },
        { key: 'lovedictionary', radius: 20, speed: 0.15, size: 1.0, yOffset: -2 },
        { key: 'moonleaf', radius: 23, speed: -0.12, size: 1.1, yOffset: 0.5 }
      ];

      planetConfigs.forEach((config, index) => {
        const data = portfolioData[config.key];
        
        // Planet group
        const planetGroup = new THREE.Group();
        
        // Main planet sphere with stylized texture
        const geometry = new THREE.SphereGeometry(config.size, 64, 64);
        
        // Create canvas texture for variety
        const canvas = document.createElement('canvas');
        canvas.width = 512;
        canvas.height = 512;
        const ctx = canvas.getContext('2d');
        
        // Base gradient
        const gradient = ctx.createLinearGradient(0, 0, 512, 512);
        const baseColor = `#${data.color.toString(16).padStart(6, '0')}`;
        gradient.addColorStop(0, baseColor);
        gradient.addColorStop(0.5, shadeColor(baseColor, 20));
        gradient.addColorStop(1, shadeColor(baseColor, -30));
        ctx.fillStyle = gradient;
        ctx.fillRect(0, 0, 512, 512);
        
        // Add noise/texture
        for (let i = 0; i < 3000; i++) {
          const x = Math.random() * 512;
          const y = Math.random() * 512;
          const size = Math.random() * 3;
          const alpha = Math.random() * 0.3;
          ctx.fillStyle = `rgba(255, 255, 255, ${alpha})`;
          ctx.fillRect(x, y, size, size);
        }
        
        // Add some circular features
        for (let i = 0; i < 8; i++) {
          const x = Math.random() * 512;
          const y = Math.random() * 512;
          const radius = Math.random() * 40 + 10;
          const alpha = Math.random() * 0.15;
          ctx.fillStyle = `rgba(0, 0, 0, ${alpha})`;
          ctx.beginPath();
          ctx.arc(x, y, radius, 0, Math.PI * 2);
          ctx.fill();
        }
        
        const texture = new THREE.CanvasTexture(canvas);
        
        const material = new THREE.MeshPhongMaterial({
          map: texture,
          color: 0xffffff,
          emissive: data.color,
          emissiveIntensity: 0.2,
          shininess: 80,
          specular: 0x444444,
          bumpScale: 0.05
        });
        material.bumpMap = texture;
        
        const planet = new THREE.Mesh(geometry, material);
        
        // Glow effect
        const glowGeometry = new THREE.SphereGeometry(config.size * 1.3, 32, 32);
        const glowMaterial = new THREE.MeshBasicMaterial({
          color: data.color,
          transparent: true,
          opacity: 0.15,
          side: THREE.BackSide
        });
        const glow = new THREE.Mesh(glowGeometry, glowMaterial);
        
        // Ring for some planets
        if (index % 2 === 0) {
          const ringGeometry = new THREE.RingGeometry(config.size * 1.5, config.size * 2, 32);
          const ringMaterial = new THREE.MeshBasicMaterial({
            color: data.color,
            transparent: true,
            opacity: 0.3,
            side: THREE.DoubleSide
          });
          const ring = new THREE.Mesh(ringGeometry, ringMaterial);
          ring.rotation.x = Math.PI / 2 + Math.random() * 0.5;
          planetGroup.add(ring);
        }

        planetGroup.add(planet);
        planetGroup.add(glow);
        
        // Store planet data
        planetGroup.userData = {
          key: config.key,
          orbitRadius: config.radius,
          orbitSpeed: config.speed,
          angle: (index / planetConfigs.length) * Math.PI * 2,
          yOffset: config.yOffset,
          baseY: config.yOffset,
          planet: planet
        };

        // Initial position
        planetGroup.position.x = Math.cos(planetGroup.userData.angle) * config.radius;
        planetGroup.position.z = Math.sin(planetGroup.userData.angle) * config.radius;
        planetGroup.position.y = config.yOffset;

        planets.push(planetGroup);
        scene.add(planetGroup);

        // Add moons to certain planets
        if (config.key === 'certifications' || config.key === 'lakesarea' || config.key === 'moonleaf') {
          const moonCount = config.key === 'lakesarea' ? 2 : 1;
          
          for (let m = 0; m < moonCount; m++) {
            const moonSize = 0.3 + Math.random() * 0.2;
            const moonOrbitRadius = config.size * 2 + m * 0.8;
            const moonSpeed = 1.5 + Math.random() * 0.5;
            
            // Create moon
            const moonGeometry = new THREE.SphereGeometry(moonSize, 32, 32);
            const moonMaterial = new THREE.MeshPhongMaterial({
              color: 0xaaaaaa,
              emissive: 0x333333,
              emissiveIntensity: 0.1,
              shininess: 30
            });
            const moon = new THREE.Mesh(moonGeometry, moonMaterial);
            
            // Moon glow
            const moonGlowGeometry = new THREE.SphereGeometry(moonSize * 1.3, 16, 16);
            const moonGlowMaterial = new THREE.MeshBasicMaterial({
              color: 0xcccccc,
              transparent: true,
              opacity: 0.1,
              side: THREE.BackSide
            });
            const moonGlow = new THREE.Mesh(moonGlowGeometry, moonGlowMaterial);
            moon.add(moonGlow);
            
            // Store moon data
            moon.userData = {
              parentPlanet: planetGroup,
              orbitRadius: moonOrbitRadius,
              orbitSpeed: moonSpeed,
              angle: Math.random() * Math.PI * 2,
              orbitTilt: (Math.random() - 0.5) * 0.5
            };
            
            moons.push(moon);
            planetGroup.add(moon);
            
            // Moon orbit line
            const moonOrbitGeometry = new THREE.RingGeometry(moonOrbitRadius - 0.01, moonOrbitRadius + 0.01, 64);
            const moonOrbitMaterial = new THREE.MeshBasicMaterial({
              color: 0x666666,
              transparent: true,
              opacity: 0.15,
              side: THREE.DoubleSide
            });
            const moonOrbit = new THREE.Mesh(moonOrbitGeometry, moonOrbitMaterial);
            moonOrbit.rotation.x = Math.PI / 2 + moon.userData.orbitTilt;
            planetGroup.add(moonOrbit);
          }
        }

        // Orbit line
        const orbitGeometry = new THREE.RingGeometry(config.radius - 0.02, config.radius + 0.02, 128);
        const orbitMaterial = new THREE.MeshBasicMaterial({
          color: 0x1976d2,
          transparent: true,
          opacity: 0.1,
          side: THREE.DoubleSide
        });
        const orbit = new THREE.Mesh(orbitGeometry, orbitMaterial);
        orbit.rotation.x = Math.PI / 2;
        orbit.position.y = config.yOffset;
        scene.add(orbit);
      });
    }

    // Create planet labels
    function createPlanetLabels() {
      const labelsContainer = document.getElementById('planet-labels');
      
      planets.forEach(planetGroup => {
        const data = portfolioData[planetGroup.userData.key];
        const label = document.createElement('div');
        label.className = 'planet-label';
        label.textContent = data.title;
        label.style.borderColor = `#${data.color.toString(16).padStart(6, '0')}40`;
        labelsContainer.appendChild(label);
        planetLabels.push({ element: label, planet: planetGroup });
      });
    }

    // Update label positions
    function updateLabelPositions() {
      planetLabels.forEach(({ element, planet }) => {
        // Get planet position in screen space
        const position = new THREE.Vector3();
        position.copy(planet.position);
        position.y += 2.5; // Offset above planet
        
        position.project(camera);
        
        const x = (position.x * 0.5 + 0.5) * window.innerWidth;
        const y = (-(position.y * 0.5) + 0.5) * window.innerHeight;
        
        // Check if in front of camera
        if (position.z < 1 && !currentFocus) {
          element.style.left = `${x}px`;
          element.style.top = `${y}px`;
          element.style.opacity = '1';
        } else {
          element.style.opacity = '0';
        }
      });
    }

    // Create ambient floating particles
    function createAmbientParticles() {
      const particleCount = 500;
      const geometry = new THREE.BufferGeometry();
      const positions = new Float32Array(particleCount * 3);

      for (let i = 0; i < particleCount; i++) {
        const i3 = i * 3;
        positions[i3] = (Math.random() - 0.5) * 60;
        positions[i3 + 1] = (Math.random() - 0.5) * 30;
        positions[i3 + 2] = (Math.random() - 0.5) * 60;
      }

      geometry.setAttribute('position', new THREE.BufferAttribute(positions, 3));

      const material = new THREE.PointsMaterial({
        color: 0x64b5f6,
        size: 0.1,
        transparent: true,
        opacity: 0.6,
        sizeAttenuation: true
      });

      const particles = new THREE.Points(geometry, material);
      scene.add(particles);
    }

    // Add lights
    function addLights() {
      const ambientLight = new THREE.AmbientLight(0x404040, 0.5);
      scene.add(ambientLight);

      const pointLight = new THREE.PointLight(0xffcc66, 3, 100);
      pointLight.position.set(0, 0, 0);
      scene.add(pointLight);

      const directionalLight = new THREE.DirectionalLight(0xffffff, 0.5);
      directionalLight.position.set(10, 10, 10);
      scene.add(directionalLight);
    }

    // Animation loop
    function animate() {
      requestAnimationFrame(animate);

      const delta = clock.getDelta();
      const time = clock.getElapsedTime();

      // Rotate starfield slowly
      if (starField) {
        starField.rotation.y += 0.0001;
      }

      // Animate sun elements
      scene.children.forEach(child => {
        if (child.userData.isSunGlow) {
          const scale = 1 + Math.sin(time * 2 + child.userData.glowIndex) * 0.05;
          child.scale.set(scale, scale, scale);
        }
        if (child.userData.isSunRay) {
          child.rotation.z += delta * 0.3;
          const opacity = 0.15 + Math.sin(time * 3 + child.userData.rayIndex) * 0.08;
          child.material.opacity = opacity;
        }
        if (child.userData.isSunFlares) {
          child.rotation.y += delta * 0.5;
        }
        if (child.userData.isSun) {
          child.rotation.y += delta * 0.1;
        }
      });

      // Animate planets
      planets.forEach(planetGroup => {
        if (!currentFocus || currentFocus.userData.key !== planetGroup.userData.key) {
          planetGroup.userData.angle += planetGroup.userData.orbitSpeed * delta;
          planetGroup.position.x = Math.cos(planetGroup.userData.angle) * planetGroup.userData.orbitRadius;
          planetGroup.position.z = Math.sin(planetGroup.userData.angle) * planetGroup.userData.orbitRadius;
          // Reduced vertical oscillation to prevent collision
          planetGroup.position.y = planetGroup.userData.baseY + Math.sin(time * 0.5 + planetGroup.userData.angle) * 0.2;
        }

        // Rotate planet on its axis
        planetGroup.rotation.y += delta * 0.2;
      });

      // Animate moons
      moons.forEach(moon => {
        moon.userData.angle += moon.userData.orbitSpeed * delta;
        
        const x = Math.cos(moon.userData.angle) * moon.userData.orbitRadius;
        const z = Math.sin(moon.userData.angle) * moon.userData.orbitRadius;
        const y = Math.sin(moon.userData.angle * 2) * moon.userData.orbitRadius * Math.sin(moon.userData.orbitTilt);
        
        moon.position.set(x, y, z);
        moon.rotation.y += delta * 0.5;
      });

      // Animate nebula
      nebulaClouds.forEach((nebula, i) => {
        nebula.rotation.z += 0.0002 * (i % 2 === 0 ? 1 : -1);
      });

      controls.update();
      renderer.render(scene, camera);
      
      // Update planet labels
      updateLabelPositions();
      
      // Update loading bar
      updateLoadingBar();
    }

    // Loading progress
    let loadProgress = 0;
    function updateLoadingBar() {
      if (loadProgress < 100) {
        loadProgress += 2;
        document.getElementById('loading-bar').style.width = loadProgress + '%';
        
        if (loadProgress < 30) {
          document.querySelector('.loading-text').textContent = 'Generating stars...';
        } else if (loadProgress < 60) {
          document.querySelector('.loading-text').textContent = 'Creating nebulae...';
        } else if (loadProgress < 90) {
          document.querySelector('.loading-text').textContent = 'Positioning planets...';
        } else {
          document.querySelector('.loading-text').textContent = 'Welcome to the universe!';
        }
      }
    }

    // Window resize
    function onWindowResize() {
      camera.aspect = window.innerWidth / window.innerHeight;
      camera.updateProjectionMatrix();
      renderer.setSize(window.innerWidth, window.innerHeight);
    }

    // Mouse move for hover effects
    function onMouseMove(event) {
      mouse.x = (event.clientX / window.innerWidth) * 2 - 1;
      mouse.y = -(event.clientY / window.innerHeight) * 2 + 1;

      raycaster.setFromCamera(mouse, camera);
      
      const planetMeshes = planets.map(p => p.userData.planet);
      const intersects = raycaster.intersectObjects(planetMeshes);

      // Reset previous hover
      if (currentHover && (!intersects.length || intersects[0].object !== currentHover.userData.planet)) {
        currentHover.userData.planet.material.emissiveIntensity = 0.2;
        currentHover.children.forEach(child => {
          if (child.material && child.material.opacity !== undefined) {
            child.material.opacity = 0.15;
          }
        });
        currentHover = null;
      }

      // Apply new hover
      if (intersects.length > 0 && !currentFocus) {
        const hoveredPlanet = planets.find(p => p.userData.planet === intersects[0].object);
        if (hoveredPlanet) {
          currentHover = hoveredPlanet;
          hoveredPlanet.userData.planet.material.emissiveIntensity = 0.5;
          // Brighten glow
          hoveredPlanet.children.forEach(child => {
            if (child.material && child.material.opacity !== undefined && child !== hoveredPlanet.userData.planet) {
              child.material.opacity = 0.35;
            }
          });
        }
      }

      document.body.style.cursor = intersects.length > 0 && !currentFocus ? 'pointer' : 'default';
    }

    // Mouse click
    function onMouseClick(event) {
      if (isAnimating) return;

      mouse.x = (event.clientX / window.innerWidth) * 2 - 1;
      mouse.y = -(event.clientY / window.innerHeight) * 2 + 1;

      raycaster.setFromCamera(mouse, camera);
      
      const planetMeshes = planets.map(p => p.userData.planet);
      const intersects = raycaster.intersectObjects(planetMeshes);

      if (intersects.length > 0) {
        const clickedPlanet = planets.find(p => p.userData.planet === intersects[0].object);
        if (clickedPlanet) {
          focusOnPlanet(clickedPlanet);
        }
      }
    }

    // Touch support for mobile devices
    let touchStartPos = { x: 0, y: 0 };
    let touchStartTime = 0;
    
    function onTouchStart(event) {
      if (event.touches.length === 1) {
        touchStartPos.x = event.touches[0].clientX;
        touchStartPos.y = event.touches[0].clientY;
        touchStartTime = Date.now();
      }
    }
    
    function onTouchEnd(event) {
      if (isAnimating) return;
      
      // Only trigger if it was a quick tap (not a drag/pan gesture)
      const touchDuration = Date.now() - touchStartTime;
      const touch = event.changedTouches[0];
      const moveDistance = Math.sqrt(
        Math.pow(touch.clientX - touchStartPos.x, 2) + 
        Math.pow(touch.clientY - touchStartPos.y, 2)
      );
      
      // If touch was short and didn't move much, treat as a tap
      if (touchDuration < 300 && moveDistance < 20) {
        mouse.x = (touch.clientX / window.innerWidth) * 2 - 1;
        mouse.y = -(touch.clientY / window.innerHeight) * 2 + 1;

        raycaster.setFromCamera(mouse, camera);
        
        const planetMeshes = planets.map(p => p.userData.planet);
        const intersects = raycaster.intersectObjects(planetMeshes);

        if (intersects.length > 0) {
          const clickedPlanet = planets.find(p => p.userData.planet === intersects[0].object);
          if (clickedPlanet) {
            event.preventDefault(); // Prevent any default touch behavior
            focusOnPlanet(clickedPlanet);
          }
        }
      }
    }

    // Focus camera on planet
    function focusOnPlanet(planetGroup) {
      if (isAnimating) return;
      isAnimating = true;
      currentFocus = planetGroup;

      controls.autoRotate = false;
      document.getElementById('back-btn').classList.add('visible');
      document.getElementById('nav-hint').style.opacity = '0';

      const targetPosition = new THREE.Vector3(
        planetGroup.position.x + focusDistance * 0.7,
        planetGroup.position.y + 2,
        planetGroup.position.z + focusDistance * 0.7
      );

      const startPosition = camera.position.clone();
      const startTarget = controls.target.clone();
      const endTarget = planetGroup.position.clone();

      let progress = 0;
      const duration = 1500;
      const startTime = Date.now();

      function animateCamera() {
        const elapsed = Date.now() - startTime;
        progress = Math.min(elapsed / duration, 1);
        
        // Easing function
        const eased = 1 - Math.pow(1 - progress, 3);

        camera.position.lerpVectors(startPosition, targetPosition, eased);
        controls.target.lerpVectors(startTarget, endTarget, eased);

        if (progress < 1) {
          requestAnimationFrame(animateCamera);
        } else {
          isAnimating = false;
          showInfoPanel(planetGroup.userData.key);
        }
      }

      animateCamera();
    }

    // Return to overview
    function returnToOverview() {
      if (isAnimating) return;
      isAnimating = true;

      closePanel();
      document.getElementById('back-btn').classList.remove('visible');

      const targetPosition = new THREE.Vector3(defaultCameraPos.x, defaultCameraPos.y, defaultCameraPos.z);
      const startPosition = camera.position.clone();
      const startTarget = controls.target.clone();
      const endTarget = new THREE.Vector3(0, 0, 0);

      let progress = 0;
      const duration = 1500;
      const startTime = Date.now();

      function animateCamera() {
        const elapsed = Date.now() - startTime;
        progress = Math.min(elapsed / duration, 1);
        
        const eased = 1 - Math.pow(1 - progress, 3);

        camera.position.lerpVectors(startPosition, targetPosition, eased);
        controls.target.lerpVectors(startTarget, endTarget, eased);

        if (progress < 1) {
          requestAnimationFrame(animateCamera);
        } else {
          currentFocus = null;
          isAnimating = false;
          controls.autoRotate = true;
          document.getElementById('nav-hint').style.opacity = '1';
          // Force label update
          updateLabelPositions();
        }
      }

      animateCamera();
    }

    // Helper function to lighten/darken colors
    function shadeColor(color, percent) {
      const num = parseInt(color.replace('#', ''), 16);
      const amt = Math.round(2.55 * percent);
      const R = (num >> 16) + amt;
      const G = (num >> 8 & 0x00FF) + amt;
      const B = (num & 0x0000FF) + amt;
      return '#' + (0x1000000 + (R < 255 ? R < 1 ? 0 : R : 255) * 0x10000 +
        (G < 255 ? G < 1 ? 0 : G : 255) * 0x100 +
        (B < 255 ? B < 1 ? 0 : B : 255))
        .toString(16).slice(1);
    }

    // Show info panel
    function showInfoPanel(key) {
      const data = portfolioData[key];
      document.getElementById('panel-title').textContent = data.title;
      
      let content = data.content;
      if (data.links.length > 0) {
        content += '<div style="margin-top: 20px;">';
        data.links.forEach(link => {
          if (link.onclick) {
            content += `<a href="${link.url}" class="btn" onclick="${link.onclick}; return false;">${link.text}</a>`;
          } else {
            content += `<a href="${link.url}" class="btn" target="_blank">${link.text}</a>`;
          }
        });
        content += '</div>';
      }
      
      document.getElementById('panel-content').innerHTML = content;
      document.getElementById('info-panel').classList.add('active');
    }

    // Close info panel
    function closePanel() {
      document.getElementById('info-panel').classList.remove('active');
    }

    // Documentation modal (kept for compatibility)
    function openDocumentation() {
      window.open('../public/PORTFOLIO_PROJECT_CASE_STUDY.md', '_blank');
    }

    // Initialize when DOM is ready
    document.addEventListener('DOMContentLoaded', init);
  </script>
</body>
</html>
